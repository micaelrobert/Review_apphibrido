<div class="card">
    <h2>ğŸ“‹ Gerenciador de Tarefas</h2>
    <p><%= description %></p>
</div>

<div class="card">
    <h3>ğŸ“ Suas Tarefas</h3>
    <div style="margin-top: 20px;">
        <% tasks.forEach(function(task) { %>
        <div style="background: rgba(0, 0, 0, 0.2); padding: 15px; border-radius: 10px; margin: 10px 0; display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h4 style="margin: 0; color: <%= task.completed ? '#4ade80' : '#fbbf24' %>;">
                    <%= task.completed ? 'âœ…' : 'â³' %> <%= task.title %>
                </h4>
                <p style="margin: 5px 0 0 0; opacity: 0.8; font-size: 0.9rem;">
                    ID: <%= task.id %> | Status: <%= task.completed ? 'ConcluÃ­da' : 'Pendente' %>
                </p>
            </div>
            <div>
                <% if (task.completed) { %>
                    <span style="color: #4ade80; font-weight: bold;">âœ… ConcluÃ­da</span>
                <% } else { %>
                    <span style="color: #fbbf24; font-weight: bold;">â³ Pendente</span>
                <% } %>
            </div>
        </div>
        <% }); %>
    </div>
</div>

<div class="card">
    <h3>ğŸ§ª Teste da API de Tarefas</h3>
    <p>Teste as funcionalidades da API de tarefas:</p>
    <div style="margin-top: 15px;">
        <a href="/api/tarefas" class="btn">ğŸ“‹ Listar Tarefas (JSON)</a>
        <button onclick="testarCriarTarefa()" class="btn" style="margin-left: 10px;">â• Criar Tarefa</button>
        <button onclick="testarAtualizarTarefa()" class="btn" style="margin-left: 10px;">ğŸ”„ Atualizar Tarefa</button>
        <button onclick="testarDeletarTarefa()" class="btn" style="margin-left: 10px;">ğŸ—‘ï¸ Deletar Tarefa</button>
    </div>
</div>

<div class="card">
    <h3>ğŸ“Š EstatÃ­sticas</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
        <div style="background: rgba(0, 0, 0, 0.2); padding: 15px; border-radius: 10px; text-align: center;">
            <h4 style="color: #4ade80; margin: 0;"><%= tasks.filter(t => t.completed).length %></h4>
            <p style="margin: 5px 0 0 0; opacity: 0.8;">ConcluÃ­das</p>
        </div>
        <div style="background: rgba(0, 0, 0, 0.2); padding: 15px; border-radius: 10px; text-align: center;">
            <h4 style="color: #fbbf24; margin: 0;"><%= tasks.filter(t => !t.completed).length %></h4>
            <p style="margin: 5px 0 0 0; opacity: 0.8;">Pendentes</p>
        </div>
        <div style="background: rgba(0, 0, 0, 0.2); padding: 15px; border-radius: 10px; text-align: center;">
            <h4 style="color: #60a5fa; margin: 0;"><%= tasks.length %></h4>
            <p style="margin: 5px 0 0 0; opacity: 0.8;">Total</p>
        </div>
    </div>
</div>

<script>
function testarCriarTarefa() {
    const titulo = prompt('Digite o tÃ­tulo da tarefa:');
    if (titulo) {
        fetch('/api/tarefas', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                titulo: titulo,
                descricao: 'Tarefa criada via interface'
            })
        })
        .then(response => response.json())
        .then(data => {
            alert('Tarefa criada com sucesso!\\n\\nResposta: ' + JSON.stringify(data, null, 2));
            location.reload();
        })
        .catch(error => {
            alert('Erro ao criar tarefa: ' + error.message);
        });
    }
}

function testarAtualizarTarefa() {
    const id = prompt('Digite o ID da tarefa para atualizar:');
    if (id) {
        fetch(`/api/tarefas/${id}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                titulo: 'Tarefa atualizada',
                descricao: 'DescriÃ§Ã£o atualizada via interface',
                concluida: true
            })
        })
        .then(response => response.json())
        .then(data => {
            alert('Tarefa atualizada com sucesso!\\n\\nResposta: ' + JSON.stringify(data, null, 2));
        })
        .catch(error => {
            alert('Erro ao atualizar tarefa: ' + error.message);
        });
    }
}

function testarDeletarTarefa() {
    const id = prompt('Digite o ID da tarefa para deletar:');
    if (id) {
        if (confirm(`Tem certeza que deseja deletar a tarefa ${id}?`)) {
            fetch(`/api/tarefas/${id}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                alert('Tarefa deletada com sucesso!\\n\\nResposta: ' + JSON.stringify(data, null, 2));
            })
            .catch(error => {
                alert('Erro ao deletar tarefa: ' + error.message);
            });
        }
    }
}
</script>


