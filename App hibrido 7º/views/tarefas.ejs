<%- include('partials/header') %>

<div class="container">
    <div class="header-section">
        <h1>üìã Gerenciador de Tarefas</h1>
        <p><%= description %></p>
        <div class="task-counter">
            <strong><%= completedTasks %>/<%= tasks.length %></strong> tarefas conclu√≠das
        </div>
    </div>

    <div class="card add-task-card">
        <h3>Adicionar Nova Tarefa</h3>
        <form action="/tarefas/add" method="POST" id="addTaskForm">
            <div class="form-group">
                <input type="text" id="title" name="title" placeholder="T√≠tulo da tarefa" required>
            </div>
            <div class="form-group">
                <textarea id="description" name="description" placeholder="Descri√ß√£o da tarefa" required></textarea>
            </div>
            <div class="form-group">
                <select id="priority" name="priority" required>
                    <option value="" disabled selected>Selecione a prioridade</option>
                    <option value="baixa">Baixa</option>
                    <option value="media">M√©dia</option>
                    <option value="alta">Alta</option>
                </select>
            </div>
            <button type="submit" class="btn">Adicionar Tarefa</button>
        </form>
    </div>

    <div class="task-list">
        <% tasks.forEach(function(task) { %>
            <div class="card task-card <%= task.completed ? 'completed' : '' %> priority-<%= task.priority %>">
                <div class="task-content">
                    <div class="task-header">
                        <h4 class="<%= task.completed ? 'task-title-completed' : '' %>">
                            <%= task.title %>
                        </h4>
                        <span class="priority-badge priority-<%= task.priority %>"><%= task.priority %></span>
                    </div>
                    <p><%= task.description %></p>
                </div>
                <div class="task-actions">
                     <form action="/tarefas/toggle/<%= task.id %>" method="POST" style="display: inline;">
                        <input type="checkbox" onchange="this.form.submit()" <%= task.completed ? 'checked' : '' %}>
                    </form>
                    <form action="/tarefas/delete/<%= task.id %>" method="POST" onsubmit="return confirm('Tem certeza que deseja excluir esta tarefa?');">
                        <button type="submit" class="btn-delete">üóëÔ∏è</button>
                    </form>
                </div>
            </div>
        <% }); %>
    </div>
</div>

<%- include('partials/footer') %>